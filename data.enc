const fs = require("fs");
const crypto = require("crypto");

const password = "Test";
const content = `
<h1>Infos familiales</h1>
<p>Texte priv√© ici</p>
`;

const salt = crypto.randomBytes(16);
const iv = crypto.randomBytes(12);

crypto.pbkdf2(password, salt, 100000, 32, "sha256", (err, key) => {
  const cipher = crypto.createCipheriv("aes-256-gcm", key, iv);
  const encrypted = Buffer.concat([
    salt,
    iv,
    cipher.update(content, "utf8"),
    cipher.final(),
  ]);

  fs.writeFileSync("data.enc", encrypted.toString("base64"));
});
